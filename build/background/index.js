"use strict";(()=>{var ur=Object.create;var ge=Object.defineProperty;var pr=Object.getOwnPropertyDescriptor;var dr=Object.getOwnPropertyNames;var gr=Object.getPrototypeOf,xr=Object.prototype.hasOwnProperty;var z=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports);var cr=(e,r,t,s)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of dr(r))!xr.call(e,n)&&n!==t&&ge(e,n,{get:()=>r[n],enumerable:!(s=pr(r,n))||s.enumerable});return e};var xe=(e,r,t)=>(t=e!=null?ur(gr(e)):{},cr(r||!e||!e.__esModule?ge(t,"default",{value:e,enumerable:!0}):t,e));var Ae=z((vo,ce)=>{"use strict";ce.exports=()=>{let e={};return e.promise=new Promise((r,t)=>{e.resolve=r,e.reject=t}),e}});var be=z((wo,ye)=>{"use strict";var Ar=Ae();function yr(e,r="maxAge"){let t,s,n,y=async()=>{if(t!==void 0)return;let x=async b=>{n=Ar();let k=b[1][r]-Date.now();if(k<=0){e.delete(b[0]),n.resolve();return}return t=b[0],s=setTimeout(()=>{e.delete(b[0]),n&&n.resolve()},k),typeof s.unref=="function"&&s.unref(),n.promise};try{for(let b of e)await x(b)}catch{}t=void 0},p=()=>{t=void 0,s!==void 0&&(clearTimeout(s),s=void 0),n!==void 0&&(n.reject(void 0),n=void 0)},g=e.set.bind(e);return e.set=(x,b)=>{e.has(x)&&e.delete(x);let k=g(x,b);return t&&t===x&&p(),y(),k},y(),e}ye.exports=yr});var ve=z((To,he)=>{"use strict";var br=be(),ne=class{constructor(r,t){if(this.maxAge=r,this[Symbol.toStringTag]="Map",this.data=new Map,br(this.data),t)for(let[s,n]of t)this.set(s,n)}get size(){return this.data.size}clear(){this.data.clear()}delete(r){return this.data.delete(r)}has(r){return this.data.has(r)}get(r){let t=this.data.get(r);if(t)return t.data}set(r,t){return this.data.set(r,{maxAge:Date.now()+this.maxAge,data:t}),this}values(){return this.createIterator(r=>r[1].data)}keys(){return this.data.keys()}entries(){return this.createIterator(r=>[r[0],r[1].data])}forEach(r,t){for(let[s,n]of this.entries())r.apply(t,[n,s,this])}[Symbol.iterator](){return this.entries()}*createIterator(r){for(let t of this.data.entries())yield r(t)}};he.exports=ne});var je=z((me,Te)=>{(function(e,r){if(typeof define=="function"&&define.amd)define("webextension-polyfill",["module"],r);else if(typeof me<"u")r(Te);else{var t={exports:{}};r(t),e.browser=t.exports}})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:me,function(e){"use strict";if(!globalThis.chrome?.runtime?.id)throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){let r="The message port closed before a response was received.",t=s=>{let n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(n).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class y extends WeakMap{constructor(a,i=void 0){super(i),this.createItem=a}get(a){return this.has(a)||this.set(a,this.createItem(a)),super.get(a)}}let p=o=>o&&typeof o=="object"&&typeof o.then=="function",g=(o,a)=>(...i)=>{s.runtime.lastError?o.reject(new Error(s.runtime.lastError.message)):a.singleCallbackArg||i.length<=1&&a.singleCallbackArg!==!1?o.resolve(i[0]):o.resolve(i)},x=o=>o==1?"argument":"arguments",b=(o,a)=>function(m,...c){if(c.length<a.minArgs)throw new Error(`Expected at least ${a.minArgs} ${x(a.minArgs)} for ${o}(), got ${c.length}`);if(c.length>a.maxArgs)throw new Error(`Expected at most ${a.maxArgs} ${x(a.maxArgs)} for ${o}(), got ${c.length}`);return new Promise((j,O)=>{if(a.fallbackToNoCallback)try{m[o](...c,g({resolve:j,reject:O},a))}catch(f){console.warn(`${o} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,f),m[o](...c),a.fallbackToNoCallback=!1,a.noCallback=!0,j()}else a.noCallback?(m[o](...c),j()):m[o](...c,g({resolve:j,reject:O},a))})},k=(o,a,i)=>new Proxy(a,{apply(m,c,j){return i.call(c,o,...j)}}),v=Function.call.bind(Object.prototype.hasOwnProperty),w=(o,a={},i={})=>{let m=Object.create(null),c={has(O,f){return f in o||f in m},get(O,f,P){if(f in m)return m[f];if(!(f in o))return;let d=o[f];if(typeof d=="function")if(typeof a[f]=="function")d=k(o,o[f],a[f]);else if(v(i,f)){let W=b(f,i[f]);d=k(o,o[f],W)}else d=d.bind(o);else if(typeof d=="object"&&d!==null&&(v(a,f)||v(i,f)))d=w(d,a[f],i[f]);else if(v(i,"*"))d=w(d,a[f],i["*"]);else return Object.defineProperty(m,f,{configurable:!0,enumerable:!0,get(){return o[f]},set(W){o[f]=W}}),d;return m[f]=d,d},set(O,f,P,d){return f in m?m[f]=P:o[f]=P,!0},defineProperty(O,f,P){return Reflect.defineProperty(m,f,P)},deleteProperty(O,f){return Reflect.deleteProperty(m,f)}},j=Object.create(o);return new Proxy(j,c)},u=o=>({addListener(a,i,...m){a.addListener(o.get(i),...m)},hasListener(a,i){return a.hasListener(o.get(i))},removeListener(a,i){a.removeListener(o.get(i))}}),I=new y(o=>typeof o!="function"?o:function(i){let m=w(i,{},{getContent:{minArgs:0,maxArgs:0}});o(m)}),S=new y(o=>typeof o!="function"?o:function(i,m,c){let j=!1,O,f=new Promise($=>{O=function(M){j=!0,$(M)}}),P;try{P=o(i,m,O)}catch($){P=Promise.reject($)}let d=P!==!0&&p(P);if(P!==!0&&!d&&!j)return!1;let W=$=>{$.then(M=>{c(M)},M=>{let se;M&&(M instanceof Error||typeof M.message=="string")?se=M.message:se="An unexpected error occurred",c({__mozWebExtensionPolyfillReject__:!0,message:se})}).catch(M=>{console.error("Failed to send onMessage rejected reply",M)})};return W(d?P:f),!0}),C=({reject:o,resolve:a},i)=>{s.runtime.lastError?s.runtime.lastError.message===r?a():o(new Error(s.runtime.lastError.message)):i&&i.__mozWebExtensionPolyfillReject__?o(new Error(i.message)):a(i)},T=(o,a,i,...m)=>{if(m.length<a.minArgs)throw new Error(`Expected at least ${a.minArgs} ${x(a.minArgs)} for ${o}(), got ${m.length}`);if(m.length>a.maxArgs)throw new Error(`Expected at most ${a.maxArgs} ${x(a.maxArgs)} for ${o}(), got ${m.length}`);return new Promise((c,j)=>{let O=C.bind(null,{resolve:c,reject:j});m.push(O),i.sendMessage(...m)})},E={devtools:{network:{onRequestFinished:u(I)}},runtime:{onMessage:u(S),onMessageExternal:u(S),sendMessage:T.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:T.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},U={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":U},services:{"*":U},websites:{"*":U}},w(s,E,n)};e.exports=t(chrome)}else e.exports=globalThis.browser})});var mr=xe(ve());var G,hr=new Uint8Array(16);function fe(){if(!G&&(G=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!G))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return G(hr)}var A=[];for(let e=0;e<256;++e)A.push((e+256).toString(16).slice(1));function we(e,r=0){return(A[e[r+0]]+A[e[r+1]]+A[e[r+2]]+A[e[r+3]]+"-"+A[e[r+4]]+A[e[r+5]]+"-"+A[e[r+6]]+A[e[r+7]]+"-"+A[e[r+8]]+A[e[r+9]]+"-"+A[e[r+10]]+A[e[r+11]]+A[e[r+12]]+A[e[r+13]]+A[e[r+14]]+A[e[r+15]]).toLowerCase()}var vr=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ie={randomUUID:vr};function wr(e,r,t){if(ie.randomUUID&&!r&&!e)return ie.randomUUID();e=e||{};let s=e.random||(e.rng||fe)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,r){t=t||0;for(let n=0;n<16;++n)r[t+n]=s[n];return r}return we(s)}var K=wr;var L=xe(je());async function ke(e,r,t,s){return fetch(`https://chat.openai.com/backend-api${t}`,{method:r,headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(s)})}async function Se(e,r){await ke(e,"POST","/conversation/message_feedback",r)}async function Oe(e,r,t){await ke(e,"PATCH",`/conversation/${r}`,t)}function Pe(e){let r,t,s,n,y,p,g;return x(),{feed:b,reset:x};function x(){r=!0,t="",s=0,n=-1,y=void 0,p=void 0,g=""}function b(v){t=t?t+v:v,r&&Tr(t)&&(t=t.slice(Ce.length)),r=!1;let w=t.length,u=0,I=!1;for(;u<w;){I&&(t[u]===`
`&&++u,I=!1);let S=-1,C=n,T;for(let E=s;S<0&&E<w;++E)T=t[E],T===":"&&C<0?C=E-u:T==="\r"?(I=!0,S=E-u):T===`
`&&(S=E-u);if(S<0){s=w-u,n=C;break}else s=0,n=-1;k(t,u,C,S),u+=S+1}u===w?t="":u>0&&(t=t.slice(u))}function k(v,w,u,I){if(I===0){g.length>0&&(e({type:"event",id:y,event:p||void 0,data:g.slice(0,-1)}),g="",y=void 0),p=void 0;return}let S=u<0,C=v.slice(w,w+(S?I:u)),T=0;S?T=I:v[w+u+1]===" "?T=u+2:T=u+1;let E=w+T,U=I-T,o=v.slice(E,E+U).toString();if(C==="data")g+=o?"".concat(o,`
`):`
`;else if(C==="event")p=o;else if(C==="id"&&!o.includes("\0"))y=o;else if(C==="retry"){let a=parseInt(o,10);Number.isNaN(a)||e({type:"reconnect-interval",value:a})}}}var Ce=[239,187,191];function Tr(e){return Ce.every((r,t)=>e.charCodeAt(t)===r)}var jr=typeof global=="object"&&global&&global.Object===Object&&global,J=jr;var kr=typeof self=="object"&&self&&self.Object===Object&&self,Sr=J||kr||Function("return this")(),h=Sr;var Or=h.Symbol,D=Or;var Ee=Object.prototype,Pr=Ee.hasOwnProperty,Cr=Ee.toString,q=D?D.toStringTag:void 0;function Er(e){var r=Pr.call(e,q),t=e[q];try{e[q]=void 0;var s=!0}catch{}var n=Cr.call(e);return s&&(r?e[q]=t:delete e[q]),n}var Ie=Er;var Ir=Object.prototype,Mr=Ir.toString;function Nr(e){return Mr.call(e)}var Me=Nr;var Br="[object Null]",Rr="[object Undefined]",Ne=D?D.toStringTag:void 0;function Lr(e){return e==null?e===void 0?Rr:Br:Ne&&Ne in Object(e)?Ie(e):Me(e)}var B=Lr;function Fr(e){return e!=null&&typeof e=="object"}var _=Fr;var Wr=Array.isArray,Be=Wr;function Dr(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}var H=Dr;var _r="[object AsyncFunction]",Ur="[object Function]",$r="[object GeneratorFunction]",qr="[object Proxy]";function Vr(e){if(!H(e))return!1;var r=B(e);return r==Ur||r==$r||r==_r||r==qr}var Z=Vr;var zr=h["__core-js_shared__"],Q=zr;var Re=function(){var e=/[^.]+$/.exec(Q&&Q.keys&&Q.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Gr(e){return!!Re&&Re in e}var Le=Gr;var Kr=Function.prototype,Jr=Kr.toString;function Hr(e){if(e!=null){try{return Jr.call(e)}catch{}try{return e+""}catch{}}return""}var R=Hr;var Zr=/[\\^$.*+?()[\]{}|]/g,Qr=/^\[object .+?Constructor\]$/,Xr=Function.prototype,Yr=Object.prototype,et=Xr.toString,rt=Yr.hasOwnProperty,tt=RegExp("^"+et.call(rt).replace(Zr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ot(e){if(!H(e)||Le(e))return!1;var r=Z(e)?tt:Qr;return r.test(R(e))}var Fe=ot;function at(e,r){return e?.[r]}var We=at;function st(e,r){var t=We(e,r);return Fe(t)?t:void 0}var N=st;var nt=N(h,"WeakMap"),X=nt;var ft=9007199254740991;function it(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=ft}var Y=it;function mt(e){return e!=null&&Y(e.length)&&!Z(e)}var De=mt;var lt=Object.prototype;function ut(e){var r=e&&e.constructor,t=typeof r=="function"&&r.prototype||lt;return e===t}var ee=ut;var pt="[object Arguments]";function dt(e){return _(e)&&B(e)==pt}var le=dt;var _e=Object.prototype,gt=_e.hasOwnProperty,xt=_e.propertyIsEnumerable,ct=le(function(){return arguments}())?le:function(e){return _(e)&&gt.call(e,"callee")&&!xt.call(e,"callee")},Ue=ct;function At(){return!1}var $e=At;var ze=typeof exports=="object"&&exports&&!exports.nodeType&&exports,qe=ze&&typeof module=="object"&&module&&!module.nodeType&&module,yt=qe&&qe.exports===ze,Ve=yt?h.Buffer:void 0,bt=Ve?Ve.isBuffer:void 0,ht=bt||$e,Ge=ht;var vt="[object Arguments]",wt="[object Array]",Tt="[object Boolean]",jt="[object Date]",kt="[object Error]",St="[object Function]",Ot="[object Map]",Pt="[object Number]",Ct="[object Object]",Et="[object RegExp]",It="[object Set]",Mt="[object String]",Nt="[object WeakMap]",Bt="[object ArrayBuffer]",Rt="[object DataView]",Lt="[object Float32Array]",Ft="[object Float64Array]",Wt="[object Int8Array]",Dt="[object Int16Array]",_t="[object Int32Array]",Ut="[object Uint8Array]",$t="[object Uint8ClampedArray]",qt="[object Uint16Array]",Vt="[object Uint32Array]",l={};l[Lt]=l[Ft]=l[Wt]=l[Dt]=l[_t]=l[Ut]=l[$t]=l[qt]=l[Vt]=!0;l[vt]=l[wt]=l[Bt]=l[Tt]=l[Rt]=l[jt]=l[kt]=l[St]=l[Ot]=l[Pt]=l[Ct]=l[Et]=l[It]=l[Mt]=l[Nt]=!1;function zt(e){return _(e)&&Y(e.length)&&!!l[B(e)]}var Ke=zt;function Gt(e){return function(r){return e(r)}}var Je=Gt;var He=typeof exports=="object"&&exports&&!exports.nodeType&&exports,V=He&&typeof module=="object"&&module&&!module.nodeType&&module,Kt=V&&V.exports===He,ue=Kt&&J.process,Jt=function(){try{var e=V&&V.require&&V.require("util").types;return e||ue&&ue.binding&&ue.binding("util")}catch{}}(),pe=Jt;var Ze=pe&&pe.isTypedArray,Ht=Ze?Je(Ze):Ke,Qe=Ht;function Zt(e,r){return function(t){return e(r(t))}}var Xe=Zt;var Qt=Xe(Object.keys,Object),Ye=Qt;var Xt=Object.prototype,Yt=Xt.hasOwnProperty;function eo(e){if(!ee(e))return Ye(e);var r=[];for(var t in Object(e))Yt.call(e,t)&&t!="constructor"&&r.push(t);return r}var er=eo;var ro=N(h,"Map"),re=ro;var to=N(h,"DataView"),te=to;var oo=N(h,"Promise"),oe=oo;var ao=N(h,"Set"),ae=ao;var rr="[object Map]",so="[object Object]",tr="[object Promise]",or="[object Set]",ar="[object WeakMap]",sr="[object DataView]",no=R(te),fo=R(re),io=R(oe),mo=R(ae),lo=R(X),F=B;(te&&F(new te(new ArrayBuffer(1)))!=sr||re&&F(new re)!=rr||oe&&F(oe.resolve())!=tr||ae&&F(new ae)!=or||X&&F(new X)!=ar)&&(F=function(e){var r=B(e),t=r==so?e.constructor:void 0,s=t?R(t):"";if(s)switch(s){case no:return sr;case fo:return rr;case io:return tr;case mo:return or;case lo:return ar}return r});var nr=F;var uo="[object Map]",po="[object Set]",go=Object.prototype,xo=go.hasOwnProperty;function co(e){if(e==null)return!0;if(De(e)&&(Be(e)||typeof e=="string"||typeof e.splice=="function"||Ge(e)||Qe(e)||Ue(e)))return!e.length;var r=nr(e);if(r==uo||r==po)return!e.size;if(ee(e))return!er(e).length;for(var t in e)if(xo.call(e,t))return!1;return!0}var de=co;async function*fr(e){let r=e.getReader();try{for(;;){let{done:t,value:s}=await r.read();if(t)return;yield s}}finally{r.releaseLock()}}async function ir(e,r){let{onMessage:t,...s}=r,n=await fetch(e,s);if(!n.ok){let p=await n.json().catch(()=>({}));throw new Error(de(p)?`${n.status} ${n.statusText}`:JSON.stringify(p))}let y=Pe(p=>{p.type==="event"&&t(p.data)});for await(let p of fr(n.body)){let g=new TextDecoder().decode(p);y.feed(g)}}var Ao="accessToken",yo=new mr.default(10*1e3);async function lr(){return"sess-1FQn9GQBpNz86XDJ8fBuVufVMJfcO6xSqTB5a4qz"}async function bo(e,r){let t=await lr(),s,n=()=>{s&&Oe(t,s,{is_visible:!1})},y=new AbortController;e.onDisconnect.addListener(()=>{y.abort(),n()}),await ir("https://chat.openai.com/backend-api/conversation",{method:"POST",signal:y.signal,headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({action:"next",messages:[{id:K(),role:"user",content:{content_type:"text",parts:[r]}}],model:"text-davinci-002-render",parent_message_id:K()}),onMessage(p){var b,k,v;if(console.debug("sse message",p),p==="[DONE]"){e.postMessage({event:"DONE"}),n();return}let g=JSON.parse(p),x=(v=(k=(b=g.message)==null?void 0:b.content)==null?void 0:k.parts)==null?void 0:v[0];s=g.conversation_id,x&&e.postMessage({text:x,messageId:g.message.id,conversationId:g.conversation_id})}})}L.default.runtime.onConnect.addListener(e=>{e.onMessage.addListener(async r=>{console.debug("received msg",r);try{await bo(e,r.question)}catch(t){console.error(t),e.postMessage({error:t.message}),yo.delete(Ao)}})});L.default.runtime.onMessage.addListener(async e=>{if(e.type==="FEEDBACK"){let r=await lr();await Se(r,e.data)}else e.type==="OPEN_OPTIONS_PAGE"&&L.default.runtime.openOptionsPage()});L.default.action?L.default.action.onClicked.addListener(()=>{L.default.runtime.openOptionsPage()}):L.default.browserAction.onClicked.addListener(()=>{L.default.runtime.openOptionsPage()});})();
